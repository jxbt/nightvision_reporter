<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NightVision - Vulnerability Report</title>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
<style>
   
    .severity { font-weight: bold; }
    .critical {color: rgb(150, 5, 5);}
    .high { color: red; }
    .medium { color: orange; }
    .low { color: green; }
    .report-info { background-color: #f4f4f4; padding: 20px; margin-bottom: 20px; }
    .content-section { margin-top: 20px; }


    .badge-pill {
    padding: 0.5em 1em;
}

.critical-bg {
    background-color: rgb(150, 5, 5);
    color: white;
}

.high-bg {
    background-color: red;
    color: white;
}

.medium-bg {
    background-color: orange;
    color: white;
}

.low-bg {
    background-color: green;
    color: white;
}

.card-header {
    font-size: 1.2rem;
}

.card-body {
    font-size: 0.9rem;
}

.btn-outline-secondary {
    margin-top: 10px;
}

</style>
</head>
<body class="">
<div class="main">
    <div id="report-head">
        <div class="report-info">
            <h1 class="text-center font-weight-bold">NightVision Vulnerability Scan Report</h1>
            <div class="text-center mt-4 mb-5">

                <svg width="261" height="61" viewBox="0 0 261 61" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M56.7998 39.1493V20.3784H60.4994L69.8327 32.4991V20.3784H73.4788V39.1493H70.0467L60.4727 26.5979V39.1493H56.7998Z" fill="#050D54"/>
                    <path d="M79.5806 39.1493V20.3784H83.4701V39.1493H79.5806Z" fill="#050D54"/>
                    <path d="M98.7984 39.4442C97.4047 39.4442 96.1073 39.198 94.9089 38.7058C93.7104 38.2136 92.6565 37.5261 91.7443 36.6407C90.8321 35.7552 90.1205 34.728 89.6122 33.5563C89.104 32.3847 88.8472 31.122 88.8472 29.7631C88.8472 28.4042 89.1013 27.1389 89.6122 25.9698C90.1205 24.7982 90.824 23.7709 91.7175 22.8855C92.611 22.0001 93.6623 21.3126 94.8687 20.8203C96.0752 20.3281 97.3672 20.082 98.7449 20.082C100.299 20.082 101.765 20.3897 103.143 21.0076C104.52 21.6255 105.655 22.4869 106.548 23.5944L103.841 26.0876C103.196 25.2824 102.436 24.6751 101.562 24.2632C100.684 23.8512 99.748 23.6452 98.7449 23.6452C97.9049 23.6452 97.1265 23.803 96.4123 24.116C95.698 24.429 95.072 24.857 94.5344 25.4027C93.9967 25.9484 93.582 26.5931 93.2878 27.3341C92.9935 28.0751 92.8464 28.8857 92.8464 29.7604C92.8464 30.6352 92.9989 31.4511 93.3011 32.2001C93.6061 32.9518 94.0288 33.5991 94.5745 34.1449C95.1202 34.6906 95.7542 35.1186 96.4791 35.4316C97.2041 35.7445 97.9932 35.8997 98.8519 35.8997C99.7106 35.8997 100.551 35.7338 101.265 35.4048C101.979 35.0731 102.584 34.6103 103.076 34.0111C103.568 33.4119 103.894 32.7378 104.055 31.9861H98.5042V28.6075H108.212V29.7872C108.212 31.1809 107.974 32.4649 107.5 33.6339C107.027 34.8056 106.369 35.8248 105.529 36.6915C104.689 37.5582 103.696 38.2323 102.552 38.7165C101.407 39.2007 100.155 39.4415 98.7984 39.4415V39.4442Z" fill="#050D54"/>
                    <path d="M113.562 39.1493V20.3784H117.452V27.9408H126.087V20.3784H129.976V39.1493H126.087V31.4532H117.452V39.1493H113.562Z" fill="#050D54"/>
                    <path d="M141.669 39.1493V23.8105H135.34V20.3784H151.858V23.8105H145.556V39.1493H141.666H141.669Z" fill="#050D54"/>
                    <path d="M163.586 39.1493L155.97 20.3784H160.181L165.919 35.1555L171.79 20.3784H175.814L168.091 39.1493H163.586Z" fill="#050D54"/>
                    <path d="M180.193 39.1493V20.3784H184.082V39.1493H180.193Z" fill="#050D54"/>
                    <path d="M197.562 39.4173C196.042 39.4173 194.558 39.1364 193.111 38.5719C191.663 38.0075 190.374 37.2076 189.248 36.1724L191.473 33.3823C192.565 34.348 193.614 35.0462 194.625 35.4742C195.636 35.9022 196.703 36.1162 197.829 36.1162C198.616 36.1162 199.295 36.0226 199.868 35.8353C200.44 35.6481 200.882 35.3752 201.195 35.0168C201.508 34.6583 201.663 34.2383 201.663 33.7568C201.663 33.1121 201.43 32.6172 200.965 32.2695C200.499 31.9217 199.705 31.6489 198.578 31.4509L194.852 30.8089C193.26 30.5414 192.049 29.9769 191.219 29.1183C190.387 28.2596 189.973 27.1521 189.973 25.7931C189.973 24.6322 190.272 23.621 190.872 22.7623C191.471 21.9036 192.319 21.2482 193.418 20.7908C194.518 20.336 195.826 20.106 197.348 20.106C198.726 20.106 200.098 20.3387 201.465 20.8041C202.832 21.2696 204.044 21.9116 205.098 22.7355L203.006 25.6326C201.039 24.1319 199.063 23.3802 197.078 23.3802C196.38 23.3802 195.772 23.4685 195.253 23.6477C194.734 23.827 194.336 24.0731 194.06 24.3861C193.782 24.699 193.646 25.0709 193.646 25.4989C193.646 26.0714 193.852 26.5127 194.264 26.8257C194.676 27.1387 195.363 27.3741 196.329 27.5373L199.868 28.1285C201.746 28.4334 203.147 29.0273 204.078 29.9127C205.007 30.7982 205.472 31.9645 205.472 33.4117C205.472 34.6289 205.151 35.6882 204.506 36.5897C203.862 37.4912 202.947 38.1894 201.756 38.6816C200.566 39.1738 199.17 39.4199 197.559 39.4199L197.562 39.4173Z" fill="#050D54"/>
                    <path d="M210.477 39.1493V20.3784H214.367V39.1493H210.477Z" fill="#050D54"/>
                    <path d="M229.483 39.4442C228.09 39.4442 226.792 39.198 225.594 38.7058C224.395 38.2136 223.347 37.5261 222.443 36.6407C221.538 35.7552 220.832 34.728 220.324 33.5563C219.816 32.3847 219.559 31.122 219.559 29.7631C219.559 28.4042 219.813 27.1389 220.324 25.9698C220.832 24.7982 221.538 23.7709 222.443 22.8855C223.344 22.0001 224.395 21.3126 225.594 20.8203C226.792 20.3281 228.087 20.082 229.483 20.082C230.88 20.082 232.177 20.3281 233.386 20.8203C234.593 21.3126 235.647 22.0001 236.551 22.8855C237.452 23.7709 238.156 24.7982 238.656 25.9698C239.156 27.1415 239.408 28.4068 239.408 29.7631C239.408 31.1194 239.156 32.3873 238.656 33.5563C238.156 34.728 237.452 35.7552 236.551 36.6407C235.647 37.5261 234.593 38.2136 233.386 38.7058C232.18 39.198 230.88 39.4442 229.483 39.4442ZM229.483 35.8783C230.342 35.8783 231.129 35.7231 231.843 35.4102C232.557 35.0972 233.183 34.6692 233.721 34.1234C234.258 33.5777 234.676 32.9304 234.981 32.1787C235.286 31.427 235.435 30.6245 235.435 29.7658C235.435 28.9071 235.283 28.0805 234.981 27.3395C234.676 26.5985 234.256 25.9538 233.721 25.4081C233.183 24.8624 232.557 24.4344 231.843 24.1214C231.129 23.8084 230.342 23.6506 229.483 23.6506C228.625 23.6506 227.865 23.8084 227.151 24.1214C226.436 24.4344 225.81 24.8624 225.273 25.4081C224.738 25.9538 224.315 26.5985 224.013 27.3395C223.708 28.0805 223.558 28.8803 223.558 29.739C223.558 30.5977 223.711 31.4297 224.013 32.1787C224.318 32.9304 224.738 33.5777 225.273 34.1234C225.81 34.6692 226.434 35.0972 227.151 35.4102C227.865 35.7231 228.643 35.8783 229.483 35.8783Z" fill="#050D54"/>
                    <path d="M243.883 39.1493V20.3784H247.583L256.916 32.4991V20.3784H260.562V39.1493H257.13L247.556 26.5979V39.1493H243.883Z" fill="#050D54"/>
                    <path d="M7.53326 47.028V28.5968C7.53326 27.9949 8.32775 27.7756 8.63539 28.2945L27.6845 60.5157C27.7915 60.6949 27.9841 60.8073 28.1955 60.8073H35.3513C35.8114 60.8073 36.0949 60.307 35.8595 59.9138L8.44011 13.6566C8.33311 13.4774 8.1405 13.3677 7.93184 13.3677H0.786748C0.46039 13.3677 0.195557 13.6325 0.195557 13.9589V47.028C0.195557 47.3544 0.46039 47.6192 0.786748 47.6192H6.94207C7.26843 47.6192 7.53326 47.3544 7.53326 47.028Z" fill="#050D54"/>
                    <path d="M4.8849 1.08879L32.3043 47.346C32.4113 47.5252 32.6039 47.6349 32.8126 47.6349H39.9577C40.284 47.6349 40.5489 47.3701 40.5489 47.0437V13.9746C40.5489 13.6482 40.284 13.3834 39.9577 13.3834H33.8024C33.476 13.3834 33.2112 13.6482 33.2112 13.9746V32.4058C33.2112 33.0077 32.4167 33.227 32.109 32.708L13.0599 0.486898C12.9529 0.307668 12.7603 0.195312 12.549 0.195312H5.39317C4.93306 0.195312 4.6495 0.695553 4.8849 1.08879Z" fill="#005EEB"/>
                    </svg>
                    
            </div>
            <div class="row">
                <div class="col-6 d-flex justify-content-start"><h5 class="font-weight-bold">{{ now | get_utc_now() }}</h5></div>
                <div class="col-6 d-flex justify-content-end"><h5 class="font-weight-bold">Created By: NightVision</h5></div>
            </div>
        </div>
        <br>
        <br>
        <div id="toc" class="mx-4">
            <h2>Findings Overview:</h2>
            <table class="table m-auto">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Severity</th>
                        <th>ID</th>
                    </tr>
                </thead>
                <tbody>
                    {% for issue in issues %}
                    <tr>
                        <td>{{ issue.title }}</td>
                        <td><span class="severity {{ issue.severity | lower }}">{{ issue.severity }}</span></td>
                        <td>{{ issue.id }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <br>
    <br>
    <div class="mt-4 mx-3">
        <h2 class="mb-4">Findings Details:</h2>
        {% for issue in issues %}
        <div class="card mb-4 mx-2 shadow-sm" id="issue-{{ loop.index }}">
            <div class="card-header bg-primary text-white">
                <h4 class="my-0 font-weight-normal">{{ loop.index }}. {{ issue.title }}</h4>
            </div>
            <div class="card-body">
                <p class="card-text">{{ issue.description | safe }}</p>
                <div class="mb-2">
                    <span class="badge badge-pill {{ issue.severity | lower }}-bg">{{ issue.severity }}</span>
                </div>
               
            </div>
        </div>
        {% endfor %}
    </div>
    
</div>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
